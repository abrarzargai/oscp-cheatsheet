
![[Pasted image 20250804162549.png]]

## What Is `netsh`?

`netsh.exe` (Network Shell) is a built-in **Windows command-line tool** that lets you **configure networking settings** — like:

- Viewing network interfaces
- Modifying the firewall
- Adding routing rules
- And most importantly here: **PORT FORWARDING**
___
## Why Use `netsh` for Port Forwarding?

Let’s say:
- You have access to a **Windows 10 machine** (like from phishing or malware).
- That Windows machine is **inside a protected internal network** (e.g., `172.16.5.0/24`).
- You want to reach another **internal system** like a Domain Controller (DC), but you **can’t** reach it directly.

So... you **forward traffic** through the Windows 10 machine that you already control. That machine becomes your **pivot point**
___
```bash
[YOU - 10.10.15.5] → connect to → [10.129.15.150:8080]
                                     |
                                     └── forwards to ──► [172.16.5.25:3389] (Internal RDP)

```
___
How to Set Up the Port Forward
```cmd
netsh interface portproxy add v4tov4 listenport=<EXTERNAL_PORT> listenaddress=<EXTERNAL_IP> connectport=<INTERNAL_PORT> connectaddress=<INTERNAL_IP>
```
**Real Example:**
```cmd
netsh interface portproxy add v4tov4 listenport=8080 listenaddress=10.129.15.150 connectport=3389 connectaddress=172.16.5.25
```

### What this does:
- **Listens** on: `10.129.15.150:8080` (public-facing Windows system)
- **Forwards to**: `172.16.5.25:3389` (internal RDP service)

### Check If It Worked
```cmd
netsh interface portproxy show v4tov4
```
You should see
```cmd
Listen on ipv4:             Connect to ipv4:
Address         Port        Address         Port
--------------- ----------  --------------- ----------
10.129.15.150   8080        172.16.5.25     3389
```

### Now From Your Kali (or PwnBox), Connect Like This:
```bash
xfreerdp /u:victor /p:pass@123 /v:10.129.15.150:8080
```

Even though you're connecting to `10.129.15.150`, the traffic is secretly getting **forwarded to** `172.16.5.25:3389`.

You're **bypassing firewalls** and **pivoting into the network**.