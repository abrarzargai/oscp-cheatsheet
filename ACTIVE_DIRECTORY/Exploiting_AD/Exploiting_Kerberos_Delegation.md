### **What Is Kerberos Delegation?**

In **Active Directory**, **Kerberos Delegation** allows a service (like a web app) to **act on behalf of a user** to access resources (like a database) on another server **using that userâ€™s credentials**.

Think of it like this:

> ğŸ§‘ User â†’ ğŸŒ Web Server â†’ ğŸ—„ï¸ SQL Server
> 
> 
> Kerberos Delegation allows the web server to say:
> 
> "**Hey SQL server, Iâ€™m acting on behalf of Bob. Let me access his data.**"
> 

Without delegation, only **Bob** can directly talk to the SQL server. The web server wouldn't be able to say "Iâ€™m Bob."

### ğŸ§  **Why Is Delegation Useful?**

Imagine a front-end app (like Outlook Web App) needs to access a backend (like Exchange or SharePoint) **as the user** to pull their emails or files. That backend will only trust the user, not the web server.

So the server needs a way to **pretend to be the user**, **securely**, and thatâ€™s where **Kerberos Delegation** helps.

## ğŸ“¦ There Are 3 Types of Delegation:

### ğŸŸ¥ 1. **Unconstrained Delegation (Old & Dangerous)**

ğŸ§  **What it means:**

- Web Server can act as *any* user.
- It can talk to *any* service while pretending to be that user.
- **Very risky** because if a hacker gets control of that web server, they can **impersonate anyone** in the domain.

ğŸ’¬ **Real-world example:**

> Imagine a receptionist can use anyoneâ€™s badge to access any room in the office.
> 

ğŸ’£ **Abuse Risk:** Super high. You get TGTs and can become Domain Admin if one logs in.

### ğŸŸ¨ 2. **Constrained Delegation (KCD)**

ğŸ§  **What it means:**

- Web Server can impersonate users, but **only for specific services**.
- AD admins configure: "This server can only act on behalf of users to reach the SQL Server."

ğŸ’¬ **Real-world example:**

> Receptionist can only use your badge to access the kitchen, not HR, IT, or Finance.
> 

âœ… Safer. Can still be abused if attacker controls the web server.

### ğŸŸ© 3. **Resource-Based Constrained Delegation (RBCD)**

ğŸ§  **What it means:**

- Instead of **giving the receptionist power**, the **kitchen itself decides** who can act on behalf of users.
- The **target service** (SQL Server) says: "Only `WebServer01` is allowed to impersonate users to me."

ğŸ’¬ **Real-world example:**

> The kitchen makes a list: â€œOnly these people are allowed to bring other people's badges here.â€
> 

âœ… Most secure. Used in modern systems (cloud, automation).

ğŸ’£ **If attacker can change this list, they can sneak in**.

## ğŸ” Big Picture: Why Does It Matter in Hacking?

If you find any of these delegation settings as an attacker:

- ğŸŸ¥ **Unconstrained** â†’ Steal tickets, impersonate Domain Admin
- ğŸŸ¨ **KCD** â†’ Abuse to impersonate users to services
- ğŸŸ© **RBCD** â†’ Add yourself to the list â†’ pretend to be anyone
